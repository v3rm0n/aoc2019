<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Advent of Code 2019</title>
    <meta name="description" content="Advent of Code 2019">
    <meta name="author" content="Maido Käära">
</head>
<body>
<pre>
<code data-target-platform="junit">
import org.junit.Test
import kotlin.test.assertEquals
import java.util.concurrent.BlockingQueue
import java.util.concurrent.CountDownLatch
import java.util.concurrent.Executors
import java.util.concurrent.LinkedBlockingQueue

interface Advent {
    fun firstTask(input: List&lt;String&gt;): Any
    fun secondTask(input: List&lt;String&gt;): Any
}


class Advent6 : Advent {

    private fun orbits(input: List&lt;String&gt;) = input.map { it.split(')').let { (a, b) -&gt; b to a } }.toMap()

    override fun firstTask(input: List&lt;String&gt;) = orbits(input).let { orbits -&gt;
        orbits.values.map { planets(orbits, it).count() + 1 }.sum()
    }

    override fun secondTask(input: List&lt;String&gt;) =
        orbits(input).let { orbits -&gt;
            (planets(orbits, "YOU") to planets(orbits, "SAN"))
                .let { (you, san) -&gt;
                    you.count() + san.count() - 2 * you.intersect(san).count()
                }
        }

    private tailrec fun planets(
        orbits: Map&lt;String, String&gt;,
        planet: String,
        acc: List&lt;String&gt; = emptyList()
    ): List&lt;String&gt; {
        if (planet == "COM") return acc
        val orbitsPlanet = orbits[planet] ?: error("No planet")
        return planets(orbits, orbitsPlanet, listOf(orbitsPlanet) + acc)
    }
}




class Advent6Test {

    private val advent = Advent6()

    @Test
    fun `calculates all orbits`() {
        assertEquals(
            42, advent.firstTask(
                listOf(
                    "COM)B",
                    "B)C",
                    "C)D",
                    "D)E",
                    "E)F",
                    "B)G",
                    "G)H",
                    "D)I",
                    "E)J",
                    "J)K",
                    "K)L"
                )
            )
        )
    }

    @Test
    fun `calculates orbits from YOU to SAN`() {
        assertEquals(
            4, advent.secondTask(
                listOf(
                    "COM)B",
                    "B)C",
                    "C)D",
                    "D)E",
                    "E)F",
                    "B)G",
                    "G)H",
                    "D)I",
                    "E)J",
                    "J)K",
                    "K)L",
                    "K)YOU",
                    "I)SAN"
                )
            )
        )
    }
}

</code>
</pre>
<script src="https://unpkg.com/kotlin-playground@1" data-selector="code"></script>
</body>
</html>
