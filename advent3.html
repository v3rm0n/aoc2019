<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8">

    <title>Advent of Code 2019</title>
    <meta name="description" content="Advent of Code 2019">
    <meta name="author" content="Maido Käära">
</head>
<body>
<code data-target-platform="junit">
    import org.junit.Test
    import kotlin.test.assertEquals

    interface Advent {
        fun firstTask(input: List&lt;String&gt;): Any
        fun secondTask(input: List&lt;String&gt;): Any
    }

    

class Advent3 : Advent {

    override fun firstTask(input: List&lt;String&gt;) =
        intersections(wires(input)).map { (x, y) -&gt; abs(0 - x) + abs(0 - y) }.min() ?: "Not found!"

    override fun secondTask(input: List&lt;String&gt;) = wires(input).let { (first, second) -&gt;
        intersections(first to second).map { first.indexOf(it) + second.indexOf(it) }.min() ?: "Not found!"
    }

    private fun intersections(wires: Pair&lt;List&lt;Pair&lt;Int, Int&gt;&gt;, List&lt;Pair&lt;Int, Int&gt;&gt;&gt;) =
        wires.first.intersect(wires.second).drop(1)

    private fun wires(input: List&lt;String&gt;): Pair&lt;List&lt;Pair&lt;Int, Int&gt;&gt;, List&lt;Pair&lt;Int, Int&gt;&gt;&gt; {
        val (first, second) = input.map { mapWireToCoordinates(it.split(',')) }
        return first to second
    }

    private fun mapWireToCoordinates(wire: List&lt;String&gt;): List&lt;Pair&lt;Int, Int&gt;&gt; {
        return wire.fold(listOf(0 to 0)) { result, i -&gt;
            val amount = i.drop(1).toInt()
            result + when (i[0]) {
                'D' -&gt; move(0, -amount, result.last())
                'U' -&gt; move(0, amount, result.last())
                'L' -&gt; move(-amount, 0, result.last())
                'R' -&gt; move(amount, 0, result.last())
                else -&gt; throw IllegalStateException("Illegal move")
            }
        }
    }

    private fun move(xd: Int, yd: Int, start: Pair&lt;Int, Int&gt;): List&lt;Pair&lt;Int, Int&gt;&gt; {
        val (x1, y1) = start
        val (x2, y2) = x1 + xd to y1 + yd
        return (if (xd &lt; 0) x1.downTo(x2) else x1..x2).flatMap { x -&gt;
            (if (yd &lt; 0) y1.downTo(y2) else y1..y2).mapNotNull { y -&gt;
                if (y != y1 || x != x1) x to y else null
            }
        }
    }
}




    

class Advent3Test {
    @Test
    fun testWithValue() {
        val advent3 = Advent3()
        val input = listOf(
            "R75,D30,R83,U83,L12,D49,R71,U7,L72",
            "U62,R66,U55,R34,D71,R55,D58,R83"
        )
        assertEquals(159, advent3.firstTask(input))
        assertEquals(610, advent3.secondTask(input))
    }

    @Test
    fun testWithOther() {
        val advent3 = Advent3()
        val input = listOf(
            "R98,U47,R26,D63,R33,U87,L62,D20,R33,U53,R51",
            "U98,R91,D20,R16,D67,R40,U7,R15,U6,R7"
        )
        assertEquals(135, advent3.firstTask(input))
        assertEquals(410, advent3.secondTask(input))
    }
}

</code>
<script src="https://unpkg.com/kotlin-playground@1" data-selector="code"></script>
</body>
</html>
